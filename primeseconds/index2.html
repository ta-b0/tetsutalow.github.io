<html>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<head>
<title>素数秒を探す</title>
<!-- Google Analytics -->
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-75328966-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>
<!-- End Google Analytics -->
<script>
var primes=[];

function setUp() {
  var f=[];
  for (var i=0; 2*i+3<10000000; ++i)
    f.push(true);
  primes.push(2);
  for (var i=0; 2*i+3<10000000; ++i) {
    if (f[i]) {
      var p=2*i+3;
      primes.push(p);
      for (var j=i+p; 2*j+3<10000000; j+=p)
        f[j]=false;
    }
  }
}

function isPrime(n) {
  var l = Math.sqrt(n) + 1;
  for (var i=0; i<primes.length && primes[i] <= l; ++i) {
    if (n%primes[i]===0)
      return false;
  }
  return true;
}

function PrimeSeconds(y,m,d) {
  var ret=[];
  var s1;
  var base = (y * 10000 + m*100+d)*1000000;
  var f=[];
  var ff=[];
  var fff=[];
  var h,min,s;
  
  // 変則エラトステネスのふるいをする
  
  // 初期化
  for (h=0; h<=23; h++) {
  	ff=new Array();
  	for (min=0; min<=59; min++) {
  		fff=new Array();
  		for (s=0; s<=59; s++) {
  			fff[s]=true;
  		}
  		ff[min]=fff;
  	}
  	f[h]=ff;
  }

  for (i=0; i<primes.length && base+235959 >= primes[i]*primes[i]; i++) {
  	for (h=0; h<=23; h++) {
  		for (min=0; min<=59; min++) {
			var t=(base + h*10000+min*100) % primes[i];
			if (t==0) {
				f[h][min][0]=false;
			}
  			s = primes[i]-t;
  			while(s<60) {
  				f[h][min][s]=false;
				s+=primes[i];
  			}
  		}
  	}
  }
  
  for (h=0; h<=23; h++) {
    for (min=0; min<=59; min++) {
      for (s=0; s<=59; s++) {
	    if (f[h][min][s]) {
	    	ret.push(base+h*10000+min*100+s);
        }
      }
  	}
  }
  return ret;
}
                                 
function show() {
  var yr=document.getElementById("year");
  var mo=document.getElementById("mon");
  var da=document.getElementById("day");
  var y=+yr.value;
  var m=+mo.value;
  var d=+da.value;
  if (y<1 || y>9999 || m<1 || m>12 || d<1 || d>31) {
    alert("Error: 入力値が不正です");
    return false;
  }
  var starttime = new Date(); 
  setUp();
  var result=document.getElementById("result");
  while (result.firstChild) result.removeChild(result.firstChild);
  var tpds=PrimeSeconds(y,m,d);
  var tbl=document.createElement("table");
  for (var i=0; i<tpds.length; ++i) {
    var tr=document.createElement("tr");
    var td=document.createElement("td");
    td.innerHTML=tpds[i];
    tr.appendChild(td);
    tbl.appendChild(tr);
  }
  var t=document.createElement("p");
  t.innerHTML="Prime seconds on "+[y,m,d].join("/")+":";
  result.appendChild(t);
  result.appendChild(tbl);
  var endtime= new Date();
  t=document.createElement("p");
  t.innerHTML = "Elapsed time =" + (endtime-starttime) + "ms";
  result.appendChild(t);
  return false;
}
</script>
</head>
<body>
<h1>素数秒の検索(変則エラトステネスのふるい版)</h1>
日付と時刻を12桁の数字で表したときに素数になる秒を「素数秒」と呼ぶことにして、ある日の素数秒を探すプログラムです。
<p>
検索する日を入力して下さい
<form id="form1" onSubmit="return show();">
年 <input type="text" id="year"/>
月 <input type="text" id="mon"/>
日 <input type="text" id="day"/>
<input type="submit" />
</form>
</p>
<div id="result">
</div>
</body>
Written by <a href="http://uehara.tetsutaro.jp">Tetsutaro UEHARA</a>.<br />
<a href="../">すなばに戻る</a>
</html>
